<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Исторически пъзел</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        .container { width: 60%; margin: auto; }
        .event { padding: 10px; margin: 5px; background: lightgray; cursor: pointer; border: 1px solid #000; }
        .sortable { list-style: none; padding: 0; }
        .confetti-container { position: fixed; width: 100%; height: 100%; pointer-events: none; top: 0; left: 0; }
    </style>
</head>
<body>
    <h1>Професор Ендрева те предизвиква да подредиш събитията? Ще се справиш ли?</h1>
    <div class="container">
        <ul id="events" class="sortable"></ul>
        <button onclick="checkOrder()">Провери</button>
    </div>
    <p id="result"></p>
    <audio id="victorySound" src="https://upload.wikimedia.org/wikipedia/commons/3/39/Erika_%28instrumental%29.ogg"></audio>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0"></script>
    <script>
        const correctOrder = [
            "Фердинанд изпраща в Прага делегация, пратениците са изхвърлени през прозореца",
            "протестантския бунт от Прага изпращат войските си пред Виена",
            "протестантите не могат да превземат Виена",
            "Прага е завзет само за два часа",
            "Фридрих бяга през Шлезия",
            "Католиците продължават на север и завземат Хайделберг",
            "Кристиан IV Датски отговаря на поканата на Фридрих за помощ",
            "датските войски били побеждавани няколко пъти",
            "Кристиан IV Датски се отказва",
            "Императорът дава Мекленбург на Валенщайн",
            "Отказът на ханзейския град Щралзунд да се подчини",
            "Валенщайн е уволнен, съпротива привлича вниманието на шведския крал Густав II Адолф",
            "Швеция се възползва от смута нахлува в Германия",
            "протестантските князе в райха се обединяват около шведския крал Густав II Адолф",
            "Прага е завзет от протестантските войски, Мюнхен е завзет от протестантите",
            "Фердинанд II е уплашен и моли Валенщайн да се върне",
            "решителната битка между двете армии близо до Лайпциг, при Люцен",
            "Валенщайн започва да води преговори с протестантската страна, императорът го осъжда на смърт",
            "мир в Прага",
            "Европейските сили начело с Франция и Швеция не са доволни от този договор, наливат масло в огъня, много хора умират",
            "Вестфалският мирен договор"
        ];

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function createList() {
            let shuffledEvents = [...correctOrder];
            shuffle(shuffledEvents);
            const eventList = document.getElementById("events");
            shuffledEvents.forEach(event => {
                let li = document.createElement("li");
                li.className = "event";
                li.draggable = true;
                li.textContent = event;
                li.addEventListener("dragstart", dragStart);
                li.addEventListener("dragover", dragOver);
                li.addEventListener("drop", drop);
                eventList.appendChild(li);
            });
        }

        function dragStart(event) {
            event.dataTransfer.setData("text/plain", event.target.textContent);
            event.target.classList.add("dragging");
        }

        function dragOver(event) {
            event.preventDefault();
        }

        function drop(event) {
            event.preventDefault();
            const draggedText = event.dataTransfer.getData("text/plain");
            const draggedElement = [...document.querySelectorAll(".event")].find(el => el.textContent === draggedText);
            if (draggedElement && draggedElement !== event.target) {
                const eventList = document.getElementById("events");
                eventList.insertBefore(draggedElement, event.target);
            }
        }

        function checkOrder() {
            const currentOrder = Array.from(document.querySelectorAll(".event")).map(el => el.textContent);
            if (JSON.stringify(currentOrder) === JSON.stringify(correctOrder)) {
                document.getElementById("result").textContent = "Професор Ендрева не те елиминира (този път)";
                document.getElementById("result").style.fontSize = "2em";
                document.getElementById("result").style.color = "green";
                document.getElementById("victorySound").play().catch(error => console.log("Автостартирането на звука е блокирано."));
                launchConfetti();
            } else {
                document.getElementById("result").textContent = "Професор Ендрева казва - Player 067 you are eliminated";
                document.getElementById("result").style.color = "red";
            }
        }

        function launchConfetti() {
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
        }

        createList();
    </script>
</body>
</html>
